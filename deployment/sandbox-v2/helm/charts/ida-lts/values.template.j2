component: ida
part-of: mosip
activeProfileEnv: lts
springConfigLabel: {{ config_repo.version }} 
configServerUrl: {{ config_server.internal_url }}
exportLogs: enabled  # Let filebeat export the logs
biosdkServiceUrl: {{ biosdk_service_url }}

ingress:
   namespace: default
artifactoryUrl: http://artifactory-service.lts:80/
iamAdapterUrl: http://artifactory-service.lts:80/artifactory/libs-release-local/io/mosip/kernel/kernel-auth-adapter.jar

probe:
  period: 10 # Seconds
  timeout: 5
  livenessPeriod: 30
  failureThreshold: 15
  startupPeriod: 10
  initialDelaySeconds: 180

imagePullPolicy: Always

sitePublicUrl: {{ site.sandbox_public_url }}

isGlowroot: {{ is_glowroot }} 

dockerHub:
  private: {{ docker.hub.private }}  
  keyname: {{ docker.hub.keyname }}

services:
  auth:
    serviceName: {{ versions.services.ida.authlts.keys()[0] }} 
    dockerImage: {{ versions.services.ida.authlts.values()[0] }}
    ports:
      containerPort: 8090
      servicePort: 80
    hsmUrl: tcp://softhsm-ida:80   # Should match with softhsm chart service name and port (see, ida.yml and role/softhsm)
    ingressPath: /idauthentication/v1
    healthUrl: /idauthentication/v1/actuator/health
    hsmClientZipPath: {{ hsm_client_zip_path }}
    podconfig:
      {{ podconfig.ida.auth | to_nice_yaml(indent=6) | indent(6) }}
    annotation: /idauthentication/v1/actuator/prometheus

  internal: 
    serviceName: {{ versions.services.ida.internallts.keys()[0] }} 
    dockerImage: {{ versions.services.ida.internallts.values()[0] }}
    ports:
      containerPort: 8093
      servicePort: 80
    hsmUrl: tcp://softhsm-ida:80   
    ingressPath: /idauthentication/v1/internal
    healthUrl: /idauthentication/v1/internal/actuator/health
    hsmClientZipPath: {{ hsm_client_zip_path }}
    podconfig:
      {{ podconfig.ida.internal | to_nice_yaml(indent=6) | indent(6) }}
    annotation: /idauthentication/v1/internal/actuator/prometheus

  otp: 
    serviceName: {{ versions.services.ida.otplts.keys()[0] }} 
    dockerImage: {{ versions.services.ida.otplts.values()[0] }}
    ports:
      containerPort: 8092
      servicePort: 80
    hsmUrl: tcp://softhsm-ida:80   
    ingressPath: /idauthentication/v1/otp
    healthUrl: /idauthentication/v1/otp/actuator/health
    hsmClientZipPath: {{ hsm_client_zip_path }}
    podconfig:
      {{ podconfig.ida.otp | to_nice_yaml(indent=6) | indent(6) }}
    annotation: /idauthentication/v1/otp/actuator/prometheus

generators:
  keygen:  
    name: {{ versions.services.ida.keygen.keys()[0] }} 
    dockerImage: {{ versions.services.ida.keygen.values()[0] }}
    hsmUrl: tcp://softhsm-ida:80
    hsmClientZipPath: {{ hsm_client_zip_path }}
   
